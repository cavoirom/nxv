{"version":3,"file":"hooks.module.js","sources":["../src/index.js"],"sourcesContent":["import { options as _options } from 'preact';\n\n/** @type {number} */\nlet currentIndex;\n\n/** @type {import('./internal').Component} */\nlet currentComponent;\n\n/** @type {import('./internal').Component} */\nlet previousComponent;\n\n/** @type {number} */\nlet currentHook = 0;\n\n/** @type {Array<import('./internal').Component>} */\nlet afterPaintEffects = [];\n\nlet EMPTY = [];\n\n// Cast to use internal Options type\nconst options = /** @type {import('./internal').Options} */ (_options);\n\nlet oldBeforeDiff = options._diff;\nlet oldBeforeRender = options._render;\nlet oldAfterDiff = options.diffed;\nlet oldCommit = options._commit;\nlet oldBeforeUnmount = options.unmount;\nlet oldRoot = options._root;\n\nconst RAF_TIMEOUT = 100;\nlet prevRaf;\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._diff = vnode => {\n\tcurrentComponent = null;\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\n};\n\noptions._root = (vnode, parentDom) => {\n\tif (vnode && parentDom._children && parentDom._children._mask) {\n\t\tvnode._mask = parentDom._children._mask;\n\t}\n\n\tif (oldRoot) oldRoot(vnode, parentDom);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions._render = vnode => {\n\tif (oldBeforeRender) oldBeforeRender(vnode);\n\n\tcurrentComponent = vnode._component;\n\tcurrentIndex = 0;\n\n\tconst hooks = currentComponent.__hooks;\n\tif (hooks) {\n\t\tif (previousComponent === currentComponent) {\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentComponent._renderCallbacks = [];\n\t\t\thooks._list.forEach(hookItem => {\n\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t}\n\t\t\t\thookItem._pendingValue = EMPTY;\n\t\t\t\thookItem._nextValue = hookItem._pendingArgs = undefined;\n\t\t\t});\n\t\t} else {\n\t\t\thooks._pendingEffects.forEach(invokeCleanup);\n\t\t\thooks._pendingEffects.forEach(invokeEffect);\n\t\t\thooks._pendingEffects = [];\n\t\t\tcurrentIndex = 0;\n\t\t}\n\t}\n\tpreviousComponent = currentComponent;\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.diffed = vnode => {\n\tif (oldAfterDiff) oldAfterDiff(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tif (c.__hooks._pendingEffects.length) afterPaint(afterPaintEffects.push(c));\n\t\tc.__hooks._list.forEach(hookItem => {\n\t\t\tif (hookItem._pendingArgs) {\n\t\t\t\thookItem._args = hookItem._pendingArgs;\n\t\t\t}\n\t\t\tif (hookItem._pendingValue !== EMPTY) {\n\t\t\t\thookItem._value = hookItem._pendingValue;\n\t\t\t}\n\t\t\thookItem._pendingArgs = undefined;\n\t\t\thookItem._pendingValue = EMPTY;\n\t\t});\n\t}\n\tpreviousComponent = currentComponent = null;\n};\n\n// TODO: Improve typing of commitQueue parameter\n/** @type {(vnode: import('./internal').VNode, commitQueue: any) => void} */\noptions._commit = (vnode, commitQueue) => {\n\tcommitQueue.some(component => {\n\t\ttry {\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\n\t\t\t\tcb._value ? invokeEffect(cb) : true\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tcommitQueue.some(c => {\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\n\t\t\t});\n\t\t\tcommitQueue = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t});\n\n\tif (oldCommit) oldCommit(vnode, commitQueue);\n};\n\n/** @type {(vnode: import('./internal').VNode) => void} */\noptions.unmount = vnode => {\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\n\n\tconst c = vnode._component;\n\tif (c && c.__hooks) {\n\t\tlet hasErrored;\n\t\tc.__hooks._list.forEach(s => {\n\t\t\ttry {\n\t\t\t\tinvokeCleanup(s);\n\t\t\t} catch (e) {\n\t\t\t\thasErrored = e;\n\t\t\t}\n\t\t});\n\t\tc.__hooks = undefined;\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\n\t}\n};\n\n/**\n * Get a hook's state from the currentComponent\n * @param {number} index The index of the hook to get\n * @param {number} type The index of the hook to get\n * @returns {any}\n */\nfunction getHookState(index, type) {\n\tif (options._hook) {\n\t\toptions._hook(currentComponent, index, currentHook || type);\n\t}\n\tcurrentHook = 0;\n\n\t// Largely inspired by:\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\n\t// Other implementations to look at:\n\t// * https://codesandbox.io/s/mnox05qp8\n\tconst hooks =\n\t\tcurrentComponent.__hooks ||\n\t\t(currentComponent.__hooks = {\n\t\t\t_list: [],\n\t\t\t_pendingEffects: []\n\t\t});\n\n\tif (index >= hooks._list.length) {\n\t\thooks._list.push({ _pendingValue: EMPTY });\n\t}\n\n\treturn hooks._list[index];\n}\n\n/**\n * @template {unknown} S\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} [initialState]\n * @returns {[S, (state: S) => void]}\n */\nexport function useState(initialState) {\n\tcurrentHook = 1;\n\treturn useReducer(invokeOrReturn, initialState);\n}\n\n/**\n * @template {unknown} S\n * @template {unknown} A\n * @param {import('./index').Reducer<S, A>} reducer\n * @param {import('./index').Dispatch<import('./index').StateUpdater<S>>} initialState\n * @param {(initialState: any) => void} [init]\n * @returns {[ S, (state: S) => void ]}\n */\nexport function useReducer(reducer, initialState, init) {\n\t/** @type {import('./internal').ReducerHookState} */\n\tconst hookState = getHookState(currentIndex++, 2);\n\thookState._reducer = reducer;\n\tif (!hookState._component) {\n\t\thookState._value = [\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\n\n\t\t\taction => {\n\t\t\t\tconst currentValue = hookState._nextValue\n\t\t\t\t\t? hookState._nextValue[0]\n\t\t\t\t\t: hookState._value[0];\n\t\t\t\tconst nextValue = hookState._reducer(currentValue, action);\n\n\t\t\t\tif (currentValue !== nextValue) {\n\t\t\t\t\thookState._nextValue = [nextValue, hookState._value[1]];\n\t\t\t\t\thookState._component.setState({});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\thookState._component = currentComponent;\n\n\t\tif (!currentComponent._hasScuFromHooks) {\n\t\t\tcurrentComponent._hasScuFromHooks = true;\n\t\t\tlet prevScu = currentComponent.shouldComponentUpdate;\n\t\t\tconst prevCWU = currentComponent.componentWillUpdate;\n\n\t\t\t// If we're dealing with a forced update `shouldComponentUpdate` will\n\t\t\t// not be called. But we use that to update the hook values, so we\n\t\t\t// need to call it.\n\t\t\tcurrentComponent.componentWillUpdate = function (p, s, c) {\n\t\t\t\tif (this._force) {\n\t\t\t\t\tlet tmp = prevScu;\n\t\t\t\t\t// Clear to avoid other sCU hooks from being called\n\t\t\t\t\tprevScu = undefined;\n\t\t\t\t\tupdateHookState(p, s, c);\n\t\t\t\t\tprevScu = tmp;\n\t\t\t\t}\n\n\t\t\t\tif (prevCWU) prevCWU.call(this, p, s, c);\n\t\t\t};\n\n\t\t\t// This SCU has the purpose of bailing out after repeated updates\n\t\t\t// to stateful hooks.\n\t\t\t// we store the next value in _nextValue[0] and keep doing that for all\n\t\t\t// state setters, if we have next states and\n\t\t\t// all next states within a component end up being equal to their original state\n\t\t\t// we are safe to bail out for this specific component.\n\t\t\t/**\n\t\t\t *\n\t\t\t * @type {import('./internal').Component[\"shouldComponentUpdate\"]}\n\t\t\t */\n\t\t\t// @ts-ignore - We don't use TS to downtranspile\n\t\t\t// eslint-disable-next-line no-inner-declarations\n\t\t\tfunction updateHookState(p, s, c) {\n\t\t\t\tif (!hookState._component.__hooks) return true;\n\n\t\t\t\t/** @type {(x: import('./internal').HookState) => x is import('./internal').ReducerHookState} */\n\t\t\t\tconst isStateHook = x => !!x._component;\n\t\t\t\tconst stateHooks =\n\t\t\t\t\thookState._component.__hooks._list.filter(isStateHook);\n\n\t\t\t\tconst allHooksEmpty = stateHooks.every(x => !x._nextValue);\n\t\t\t\t// When we have no updated hooks in the component we invoke the previous SCU or\n\t\t\t\t// traverse the VDOM tree further.\n\t\t\t\tif (allHooksEmpty) {\n\t\t\t\t\treturn prevScu ? prevScu.call(this, p, s, c) : true;\n\t\t\t\t}\n\n\t\t\t\t// We check whether we have components with a nextValue set that\n\t\t\t\t// have values that aren't equal to one another this pushes\n\t\t\t\t// us to update further down the tree\n\t\t\t\tlet shouldUpdate = false;\n\t\t\t\tstateHooks.forEach(hookItem => {\n\t\t\t\t\tif (hookItem._nextValue) {\n\t\t\t\t\t\tconst currentValue = hookItem._value[0];\n\t\t\t\t\t\thookItem._value = hookItem._nextValue;\n\t\t\t\t\t\thookItem._nextValue = undefined;\n\t\t\t\t\t\tif (currentValue !== hookItem._value[0]) shouldUpdate = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn shouldUpdate || hookState._component.props !== p\n\t\t\t\t\t? prevScu\n\t\t\t\t\t\t? prevScu.call(this, p, s, c)\n\t\t\t\t\t\t: true\n\t\t\t\t\t: false;\n\t\t\t}\n\n\t\t\tcurrentComponent.shouldComponentUpdate = updateHookState;\n\t\t}\n\t}\n\n\treturn hookState._nextValue || hookState._value;\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 3);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\n\t}\n}\n\n/**\n * @param {import('./internal').Effect} callback\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useLayoutEffect(callback, args) {\n\t/** @type {import('./internal').EffectHookState} */\n\tconst state = getHookState(currentIndex++, 4);\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\n\t\tstate._value = callback;\n\t\tstate._pendingArgs = args;\n\n\t\tcurrentComponent._renderCallbacks.push(state);\n\t}\n}\n\n/** @type {(initialValue: unknown) => unknown} */\nexport function useRef(initialValue) {\n\tcurrentHook = 5;\n\treturn useMemo(() => ({ current: initialValue }), []);\n}\n\n/**\n * @param {object} ref\n * @param {() => object} createHandle\n * @param {unknown[]} args\n * @returns {void}\n */\nexport function useImperativeHandle(ref, createHandle, args) {\n\tcurrentHook = 6;\n\tuseLayoutEffect(\n\t\t() => {\n\t\t\tif (typeof ref == 'function') {\n\t\t\t\tref(createHandle());\n\t\t\t\treturn () => ref(null);\n\t\t\t} else if (ref) {\n\t\t\t\tref.current = createHandle();\n\t\t\t\treturn () => (ref.current = null);\n\t\t\t}\n\t\t},\n\t\targs == null ? args : args.concat(ref)\n\t);\n}\n\n/**\n * @template {unknown} T\n * @param {() => T} factory\n * @param {unknown[]} args\n * @returns {T}\n */\nexport function useMemo(factory, args) {\n\t/** @type {import('./internal').MemoHookState<T>} */\n\tconst state = getHookState(currentIndex++, 7);\n\tif (argsChanged(state._args, args)) {\n\t\tstate._pendingValue = factory();\n\t\tstate._pendingArgs = args;\n\t\tstate._factory = factory;\n\t\treturn state._pendingValue;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * @param {() => void} callback\n * @param {unknown[]} args\n * @returns {() => void}\n */\nexport function useCallback(callback, args) {\n\tcurrentHook = 8;\n\treturn useMemo(() => callback, args);\n}\n\n/**\n * @param {import('./internal').PreactContext} context\n */\nexport function useContext(context) {\n\tconst provider = currentComponent.context[context._id];\n\t// We could skip this call here, but than we'd not call\n\t// `options._hook`. We need to do that in order to make\n\t// the devtools aware of this hook.\n\t/** @type {import('./internal').ContextHookState} */\n\tconst state = getHookState(currentIndex++, 9);\n\t// The devtools needs access to the context object to\n\t// be able to pull of the default value when no provider\n\t// is present in the tree.\n\tstate._context = context;\n\tif (!provider) return context._defaultValue;\n\t// This is probably not safe to convert to \"!\"\n\tif (state._value == null) {\n\t\tstate._value = true;\n\t\tprovider.sub(currentComponent);\n\t}\n\treturn provider.props.value;\n}\n\n/**\n * Display a custom label for a custom hook for the devtools panel\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\n */\nexport function useDebugValue(value, formatter) {\n\tif (options.useDebugValue) {\n\t\toptions.useDebugValue(\n\t\t\tformatter ? formatter(value) : /** @type {any}*/ (value)\n\t\t);\n\t}\n}\n\n/**\n * @param {(error: unknown, errorInfo: import('preact').ErrorInfo) => void} cb\n * @returns {[unknown, () => void]}\n */\nexport function useErrorBoundary(cb) {\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\n\tconst state = getHookState(currentIndex++, 10);\n\tconst errState = useState();\n\tstate._value = cb;\n\tif (!currentComponent.componentDidCatch) {\n\t\tcurrentComponent.componentDidCatch = (err, errorInfo) => {\n\t\t\tif (state._value) state._value(err, errorInfo);\n\t\t\terrState[1](err);\n\t\t};\n\t}\n\treturn [\n\t\terrState[0],\n\t\t() => {\n\t\t\terrState[1](undefined);\n\t\t}\n\t];\n}\n\n/** @type {() => string} */\nexport function useId() {\n\t/** @type {import('./internal').IdHookState} */\n\tconst state = getHookState(currentIndex++, 11);\n\tif (!state._value) {\n\t\t// Grab either the root node or the nearest async boundary node.\n\t\t/** @type {import('./internal.d').VNode} */\n\t\tlet root = currentComponent._vnode;\n\t\twhile (root !== null && !root._mask && root._parent !== null) {\n\t\t\troot = root._parent;\n\t\t}\n\n\t\tlet mask = root._mask || (root._mask = [0, 0]);\n\t\tstate._value = 'P' + mask[0] + '-' + mask[1]++;\n\t}\n\n\treturn state._value;\n}\n\n/**\n * After paint effects consumer.\n */\nfunction flushAfterPaintEffects() {\n\tlet component;\n\twhile ((component = afterPaintEffects.shift())) {\n\t\tif (!component._parentDom || !component.__hooks) continue;\n\t\ttry {\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t} catch (e) {\n\t\t\tcomponent.__hooks._pendingEffects = [];\n\t\t\toptions._catchError(e, component._vnode);\n\t\t}\n\t}\n}\n\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\n\n/**\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\n * the next browser frame.\n *\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\n * even if RAF doesn't fire (for example if the browser tab is not visible)\n *\n * @param {() => void} callback\n */\nfunction afterNextFrame(callback) {\n\tconst done = () => {\n\t\tclearTimeout(timeout);\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\n\t\tsetTimeout(callback);\n\t};\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\n\n\tlet raf;\n\tif (HAS_RAF) {\n\t\traf = requestAnimationFrame(done);\n\t}\n}\n\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\n// Perhaps this is not such a big deal.\n/**\n * Schedule afterPaintEffects flush after the browser paints\n * @param {number} newQueueLength\n * @returns {void}\n */\nfunction afterPaint(newQueueLength) {\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\n\t\tprevRaf = options.requestAnimationFrame;\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\n\t}\n}\n\n/**\n * @param {import('./internal').HookState} hook\n * @returns {void}\n */\nfunction invokeCleanup(hook) {\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\tlet cleanup = hook._cleanup;\n\tif (typeof cleanup == 'function') {\n\t\thook._cleanup = undefined;\n\t\tcleanup();\n\t}\n\n\tcurrentComponent = comp;\n}\n\n/**\n * Invoke a Hook's effect\n * @param {import('./internal').EffectHookState} hook\n * @returns {void}\n */\nfunction invokeEffect(hook) {\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\n\t// and move the currentComponent away.\n\tconst comp = currentComponent;\n\thook._cleanup = hook._value();\n\tcurrentComponent = comp;\n}\n\n/**\n * @param {unknown[]} oldArgs\n * @param {unknown[]} newArgs\n * @returns {boolean}\n */\nfunction argsChanged(oldArgs, newArgs) {\n\treturn (\n\t\t!oldArgs ||\n\t\toldArgs.length !== newArgs.length ||\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\n\t);\n}\n\n/**\n * @template Arg\n * @param {Arg} arg\n * @param {(arg: Arg) => any} f\n * @returns {any}\n */\nfunction invokeOrReturn(arg, f) {\n\treturn typeof f == 'function' ? f(arg) : f;\n}\n"],"names":["currentIndex","currentComponent","previousComponent","currentHook","afterPaintEffects","EMPTY","options","_options","oldBeforeDiff","oldBeforeRender","oldAfterDiff","diffed","oldCommit","oldBeforeUnmount","unmount","oldRoot","RAF_TIMEOUT","prevRaf","vnode","parentDom","hooks","forEach","hookItem","_pendingArgs","undefined","invokeCleanup","invokeEffect","c","length","afterPaint","push","commitQueue","some","component","filter","cb","e","hasErrored","s","getHookState","index","type","useState","initialState","useReducer","invokeOrReturn","reducer","init","hookState","_reducer","action","currentValue","nextValue","setState","_hasScuFromHooks","updateHookState","p","isStateHook","x","stateHooks","allHooksEmpty","every","prevScu","call","shouldUpdate","props","shouldComponentUpdate","prevCWU","componentWillUpdate","tmp","useEffect","callback","args","state","argsChanged","useLayoutEffect","useRef","initialValue","useMemo","current","useImperativeHandle","ref","createHandle","concat","factory","useCallback","useContext","context","provider","sub","value","useDebugValue","formatter","useErrorBoundary","errState","componentDidCatch","err","errorInfo","useId","root","mask","flushAfterPaintEffects","shift","HAS_RAF","requestAnimationFrame","afterNextFrame","done","clearTimeout","timeout","cancelAnimationFrame","raf","setTimeout","newQueueLength","hook","comp","cleanup","oldArgs","newArgs","arg","f"],"mappings":";;AAEA;;AACA,IAAIA,YAAJ,CAAA;AAEA;;AACA,IAAIC,gBAAJ,CAAA;AAEA;;AACA,IAAIC,iBAAJ,CAAA;AAEA;;AACA,IAAIC,WAAW,GAAG,CAAlB,CAAA;AAEA;;AACA,IAAIC,iBAAiB,GAAG,EAAxB,CAAA;AAEA,IAAIC,KAAK,GAAG,EAAZ;;AAGA,IAAMC,OAAO,GAAgDC,SAA7D,CAAA;AAEA,IAAIC,aAAa,GAAGF,OAAH,CAAjB,GAAA,CAAA;AACA,IAAIG,eAAe,GAAGH,OAAH,CAAnB,GAAA,CAAA;AACA,IAAII,YAAY,GAAGJ,OAAO,CAACK,MAA3B,CAAA;AACA,IAAIC,SAAS,GAAGN,OAAH,CAAb,GAAA,CAAA;AACA,IAAIO,gBAAgB,GAAGP,OAAO,CAACQ,OAA/B,CAAA;AACA,IAAIC,OAAO,GAAGT,OAAH,CAAX,EAAA,CAAA;AAEA,IAAMU,WAAW,GAAG,GAApB,CAAA;AACA,IAAIC,OAAJ,CAAA;AAEA;;AACAX,OAAO,CAAP,GAAA,GAAgB,UAAAY,KAAK,EAAI;AACxBjB,EAAAA,gBAAgB,GAAG,IAAnB,CAAA;AACA,EAAA,IAAIO,aAAJ,EAAmBA,aAAa,CAACU,KAAD,CAAb,CAAA;AACnB,CAHD,CAAA;;AAKAZ,OAAO,GAAP,GAAgB,UAACY,KAAD,EAAQC,SAAR,EAAsB;AACrC,EAAA,IAAID,KAAK,IAAIC,SAAJ,IAAL,IAAgCA,SAAhC,QAAJ,EAA+D;AAC9DD,IAAAA,KAAK,CAAL,GAAA,GAAcC,SAAd,CAAA,GAAA,CAAA,GAAA,CAAA;AACA,GAAA;;AAED,EAAA,IAAIJ,OAAJ,EAAaA,OAAO,CAACG,KAAD,EAAQC,SAAR,CAAP,CAAA;AACb,CAND,CAAA;AAQA;;;AACAb,OAAO,CAAP,GAAA,GAAkB,UAAAY,KAAK,EAAI;AAC1B,EAAA,IAAIT,eAAJ,EAAqBA,eAAe,CAACS,KAAD,CAAf,CAAA;AAErBjB,EAAAA,gBAAgB,GAAGiB,KAAH,CAAhB,GAAA,CAAA;AACAlB,EAAAA,YAAY,GAAG,CAAf,CAAA;AAEA,EAAMoB,IAAAA,KAAK,GAAGnB,gBAAH,CAAX,GAAA,CAAA;;AACA,EAAA,IAAImB,KAAJ,EAAW;AACV,IAAIlB,IAAAA,iBAAiB,KAAKD,gBAA1B,EAA4C;AAC3CmB,MAAAA,KAAK,CAAL,GAAA,GAAwB,EAAxB,CAAA;AACAnB,MAAAA,gBAAgB,CAAhB,GAAA,GAAoC,EAApC,CAAA;;AACAmB,MAAAA,KAAK,CAAL,EAAA,CAAYC,OAAZ,CAAoB,UAAAC,QAAQ,EAAI;AAC/B,QAAA,IAAIA,QAAJ,CAAyB,GAAA,EAAA;AACxBA,UAAAA,QAAQ,CAAR,EAAA,GAAkBA,QAAlB,CAAA,GAAA,CAAA;AACA,SAAA;;AACDA,QAAAA,QAAQ,CAAR,GAAA,GAAyBjB,KAAzB,CAAA;AACAiB,QAAAA,QAAQ,CAAR,GAAA,GAAsBA,QAAQ,CAACC,YAAT,GAAwBC,SAA9C,CAAA;AACA,OAND,CAAA,CAAA;AAOA,KAVD,MAUO;AACNJ,MAAAA,KAAK,CAAA,GAAL,CAAsBC,OAAtB,CAA8BI,aAA9B,CAAA,CAAA;;AACAL,MAAAA,KAAK,CAAA,GAAL,CAAsBC,OAAtB,CAA8BK,YAA9B,CAAA,CAAA;;AACAN,MAAAA,KAAK,CAAL,GAAA,GAAwB,EAAxB,CAAA;AACApB,MAAAA,YAAY,GAAG,CAAf,CAAA;AACA,KAAA;AACD,GAAA;;AACDE,EAAAA,iBAAiB,GAAGD,gBAApB,CAAA;AACA,CA1BD,CAAA;AA4BA;;;AACAK,OAAO,CAACK,MAAR,GAAiB,UAAAO,KAAK,EAAI;AACzB,EAAA,IAAIR,YAAJ,EAAkBA,YAAY,CAACQ,KAAD,CAAZ,CAAA;AAElB,EAAMS,IAAAA,CAAC,GAAGT,KAAH,CAAP,GAAA,CAAA;;AACA,EAAA,IAAIS,CAAC,IAAIA,CAAJ,CAAA,GAAL,EAAoB;AACnB,IAAA,IAAIA,CAAC,CAAA,GAAD,CAA0BC,GAAAA,CAAAA,MAA9B,EAAsCC,UAAU,CAACzB,iBAAiB,CAAC0B,IAAlB,CAAuBH,CAAvB,CAAD,CAAV,CAAA;;AACtCA,IAAAA,CAAC,CAAD,GAAA,CAAA,EAAA,CAAgBN,OAAhB,CAAwB,UAAAC,QAAQ,EAAI;AACnC,MAAIA,IAAAA,QAAQ,CAACC,YAAb,EAA2B;AAC1BD,QAAAA,QAAQ,CAAA,GAAR,GAAiBA,QAAQ,CAACC,YAA1B,CAAA;AACA,OAAA;;AACD,MAAA,IAAID,QAAQ,CAAA,GAAR,KAA2BjB,KAA/B,EAAsC;AACrCiB,QAAAA,QAAQ,CAAR,EAAA,GAAkBA,QAAlB,CAAA,GAAA,CAAA;AACA,OAAA;;AACDA,MAAAA,QAAQ,CAACC,YAAT,GAAwBC,SAAxB,CAAA;AACAF,MAAAA,QAAQ,CAAR,GAAA,GAAyBjB,KAAzB,CAAA;AACA,KATD,CAAA,CAAA;AAUA,GAAA;;AACDH,EAAAA,iBAAiB,GAAGD,gBAAgB,GAAG,IAAvC,CAAA;AACA,CAlBD;;AAqBA;;;AACAK,OAAO,IAAP,GAAkB,UAACY,KAAD,EAAQa,WAAR,EAAwB;AACzCA,EAAAA,WAAW,CAACC,IAAZ,CAAiB,UAAAC,SAAS,EAAI;AAC7B,IAAI,IAAA;AACHA,MAAAA,SAAS,CAAA,GAAT,CAA2BZ,OAA3B,CAAmCI,aAAnC,CAAA,CAAA;;AACAQ,MAAAA,SAAS,IAAT,GAA6BA,SAAS,IAAT,CAA2BC,MAA3B,CAAkC,UAAAC,EAAE,EAAA;AAAA,QAChEA,OAAAA,EAAE,GAAF,GAAYT,YAAY,CAACS,EAAD,CAAxB,GAA+B,IADiC,CAAA;AAAA,OAApC,CAA7B,CAAA;AAGA,KALD,CAKE,OAAOC,CAAP,EAAU;AACXL,MAAAA,WAAW,CAACC,IAAZ,CAAiB,UAAAL,CAAC,EAAI;AACrB,QAAA,IAAIA,CAAJ,CAAA,GAAA,EAAwBA,CAAC,CAAA,GAAD,GAAqB,EAArB,CAAA;AACxB,OAFD,CAAA,CAAA;AAGAI,MAAAA,WAAW,GAAG,EAAd,CAAA;;AACAzB,MAAAA,OAAO,CAAA,GAAP,CAAoB8B,CAApB,EAAuBH,SAAvB,CAAA,GAAA,CAAA,CAAA;AACA,KAAA;AACD,GAbD,CAAA,CAAA;AAeA,EAAA,IAAIrB,SAAJ,EAAeA,SAAS,CAACM,KAAD,EAAQa,WAAR,CAAT,CAAA;AACf,CAjBD,CAAA;AAmBA;;;AACAzB,OAAO,CAACQ,OAAR,GAAkB,UAAAI,KAAK,EAAI;AAC1B,EAAA,IAAIL,gBAAJ,EAAsBA,gBAAgB,CAACK,KAAD,CAAhB,CAAA;AAEtB,EAAMS,IAAAA,CAAC,GAAGT,KAAH,CAAP,GAAA,CAAA;;AACA,EAAA,IAAIS,CAAC,IAAIA,CAAJ,CAAA,GAAL,EAAoB;AACnB,IAAA,IAAIU,UAAJ,CAAA;;AACAV,IAAAA,CAAC,CAAD,GAAA,CAAA,EAAA,CAAgBN,OAAhB,CAAwB,UAAAiB,CAAC,EAAI;AAC5B,MAAI,IAAA;AACHb,QAAAA,aAAa,CAACa,CAAD,CAAb,CAAA;AACA,OAFD,CAEE,OAAOF,CAAP,EAAU;AACXC,QAAAA,UAAU,GAAGD,CAAb,CAAA;AACA,OAAA;AACD,KAND,CAAA,CAAA;;AAOAT,IAAAA,CAAC,CAAD,GAAA,GAAYH,SAAZ,CAAA;AACA,IAAA,IAAIa,UAAJ,EAAgB/B,OAAO,IAAP,CAAoB+B,UAApB,EAAgCV,CAAhC,CAAA,GAAA,CAAA,CAAA;AAChB,GAAA;AACD,CAhBD,CAAA;AAkBA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASY,YAAT,CAAsBC,KAAtB,EAA6BC,IAA7B,EAAmC;AAClC,EAAA,IAAInC,OAAJ,CAAmB,GAAA,EAAA;AAClBA,IAAAA,OAAO,IAAP,CAAcL,gBAAd,EAAgCuC,KAAhC,EAAuCrC,WAAW,IAAIsC,IAAtD,CAAA,CAAA;AACA,GAAA;;AACDtC,EAAAA,WAAW,GAAG,CAAd,CAJkC;AAOlC;AACA;AACA;AACA;;AACA,EAAA,IAAMiB,KAAK,GACVnB,gBAAgB,IAAhB,KACCA,gBAAgB,IAAhB,GAA2B;AAC3B,IAAA,EAAA,EAAO,EADoB;AAE3B,IAAiB,GAAA,EAAA,EAAA;AAFU,GAD5B,CADD,CAAA;;AAOA,EAAA,IAAIuC,KAAK,IAAIpB,KAAK,CAAL,EAAA,CAAYQ,MAAzB,EAAiC;AAChCR,IAAAA,KAAK,CAAA,EAAL,CAAYU,IAAZ,CAAiB;AAAE,MAAezB,GAAAA,EAAAA,KAAAA;AAAjB,KAAjB,CAAA,CAAA;AACA,GAAA;;AAED,EAAA,OAAOe,KAAK,CAAA,EAAL,CAAYoB,KAAZ,CAAP,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;;;AACO,SAASE,QAAT,CAAkBC,YAAlB,EAAgC;AACtCxC,EAAAA,WAAW,GAAG,CAAd,CAAA;AACA,EAAA,OAAOyC,UAAU,CAACC,cAAD,EAAiBF,YAAjB,CAAjB,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,UAAT,CAAoBE,OAApB,EAA6BH,YAA7B,EAA2CI,IAA3C,EAAiD;AACvD;AACA,EAAMC,IAAAA,SAAS,GAAGT,YAAY,CAACvC,YAAY,EAAb,EAAiB,CAAjB,CAA9B,CAAA;AACAgD,EAAAA,SAAS,CAACC,QAAV,GAAqBH,OAArB,CAAA;;AACA,EAAI,IAAA,CAACE,SAAD,CAAA,GAAJ,EAA2B;AAC1BA,IAAAA,SAAS,GAAT,GAAmB,CAClB,CAACD,IAAD,GAAQF,cAAc,CAACrB,SAAD,EAAYmB,YAAZ,CAAtB,GAAkDI,IAAI,CAACJ,YAAD,CADpC,EAGlB,UAAAO,MAAM,EAAI;AACT,MAAA,IAAMC,YAAY,GAAGH,SAAS,CAAA,GAAT,GAClBA,SAAS,CAAA,GAAT,CAAqB,CAArB,CADkB,GAElBA,SAAS,CAAT,EAAA,CAAiB,CAAjB,CAFH,CAAA;;AAGA,MAAMI,IAAAA,SAAS,GAAGJ,SAAS,CAACC,QAAV,CAAmBE,YAAnB,EAAiCD,MAAjC,CAAlB,CAAA;;AAEA,MAAIC,IAAAA,YAAY,KAAKC,SAArB,EAAgC;AAC/BJ,QAAAA,SAAS,CAAT,GAAA,GAAuB,CAACI,SAAD,EAAYJ,SAAS,CAAT,EAAA,CAAiB,CAAjB,CAAZ,CAAvB,CAAA;;AACAA,QAAAA,SAAS,CAAA,GAAT,CAAqBK,QAArB,CAA8B,EAA9B,CAAA,CAAA;AACA,OAAA;AACD,KAbiB,CAAnB,CAAA;AAgBAL,IAAAA,SAAS,CAAT,GAAA,GAAuB/C,gBAAvB,CAAA;;AAEA,IAAA,IAAI,CAACA,gBAAgB,CAACqD,gBAAtB,EAAwC;AAoBvC;AACA;AACA;AACA;AACA;AACA;;AACA;AACH;AACA;AACA;AACG;AACA;AA/BuC,MAgC9BC,IAAAA,eAhC8B,GAgCvC,SAASA,eAAT,CAAyBC,CAAzB,EAA4BlB,CAA5B,EAA+BX,CAA/B,EAAkC;AACjC,QAAA,IAAI,CAACqB,SAAD,CAAJ,GAAA,CAAA,GAAA,EAAmC,OAAO,IAAP,CAAA;AAEnC;;AACA,QAAA,IAAMS,WAAW,GAAG,SAAdA,WAAc,CAAAC,CAAC,EAAA;AAAA,UAAI,OAAA,CAAC,CAACA,CAAD,CAAL,GAAA,CAAA;AAAA,SAArB,CAAA;;AACA,QAAMC,IAAAA,UAAU,GACfX,SAAS,CAAA,GAAT,QAAmCd,MAAnC,CAA0CuB,WAA1C,CADD,CAAA;;AAGA,QAAA,IAAMG,aAAa,GAAGD,UAAU,CAACE,KAAX,CAAiB,UAAAH,CAAC,EAAA;AAAA,UAAI,OAAA,CAACA,CAAD,CAAJ,GAAA,CAAA;AAAA,SAAlB,CAAtB,CARiC;AAUjC;;AACA,QAAA,IAAIE,aAAJ,EAAmB;AAClB,UAAA,OAAOE,OAAO,GAAGA,OAAO,CAACC,IAAR,CAAa,IAAb,EAAmBP,CAAnB,EAAsBlB,CAAtB,EAAyBX,CAAzB,CAAH,GAAiC,IAA/C,CAAA;AACA,SAbgC;AAgBjC;AACA;;;AACA,QAAIqC,IAAAA,YAAY,GAAG,KAAnB,CAAA;AACAL,QAAAA,UAAU,CAACtC,OAAX,CAAmB,UAAAC,QAAQ,EAAI;AAC9B,UAAA,IAAIA,QAAJ,CAAyB,GAAA,EAAA;AACxB,YAAA,IAAM6B,YAAY,GAAG7B,QAAQ,CAAR,EAAA,CAAgB,CAAhB,CAArB,CAAA;AACAA,YAAAA,QAAQ,CAAR,EAAA,GAAkBA,QAAlB,CAAA,GAAA,CAAA;AACAA,YAAAA,QAAQ,CAAR,GAAA,GAAsBE,SAAtB,CAAA;AACA,YAAI2B,IAAAA,YAAY,KAAK7B,QAAQ,CAAR,EAAA,CAAgB,CAAhB,CAArB,EAAyC0C,YAAY,GAAG,IAAf,CAAA;AACzC,WAAA;AACD,SAPD,CAAA,CAAA;AASA,QAAOA,OAAAA,YAAY,IAAIhB,SAAS,CAAT,GAAA,CAAqBiB,KAArB,KAA+BT,CAA/C,GACJM,OAAO,GACNA,OAAO,CAACC,IAAR,CAAa,IAAb,EAAmBP,CAAnB,EAAsBlB,CAAtB,EAAyBX,CAAzB,CADM,GAEN,IAHG,GAIJ,KAJH,CAAA;AAKA,OAjEsC,CAAA;;AACvC1B,MAAAA,gBAAgB,CAACqD,gBAAjB,GAAoC,IAApC,CAAA;AACA,MAAA,IAAIQ,OAAO,GAAG7D,gBAAgB,CAACiE,qBAA/B,CAAA;AACA,MAAA,IAAMC,OAAO,GAAGlE,gBAAgB,CAACmE,mBAAjC,CAHuC;AAMvC;AACA;;AACAnE,MAAAA,gBAAgB,CAACmE,mBAAjB,GAAuC,UAAUZ,CAAV,EAAalB,CAAb,EAAgBX,CAAhB,EAAmB;AACzD,QAAA,IAAI,IAAJ,CAAiB,GAAA,EAAA;AAChB,UAAA,IAAI0C,GAAG,GAAGP,OAAV,CADgB;;AAGhBA,UAAAA,OAAO,GAAGtC,SAAV,CAAA;AACA+B,UAAAA,eAAe,CAACC,CAAD,EAAIlB,CAAJ,EAAOX,CAAP,CAAf,CAAA;AACAmC,UAAAA,OAAO,GAAGO,GAAV,CAAA;AACA,SAAA;;AAED,QAAA,IAAIF,OAAJ,EAAaA,OAAO,CAACJ,IAAR,CAAa,IAAb,EAAmBP,CAAnB,EAAsBlB,CAAtB,EAAyBX,CAAzB,CAAA,CAAA;AACb,OAVD,CAAA;;AA2DA1B,MAAAA,gBAAgB,CAACiE,qBAAjB,GAAyCX,eAAzC,CAAA;AACA,KAAA;AACD,GAAA;;AAED,EAAA,OAAOP,SAAS,CAAA,GAAT,IAAwBA,SAAxB,CAAP,EAAA,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;;AACO,SAASsB,SAAT,CAAmBC,QAAnB,EAA6BC,IAA7B,EAAmC;AACzC;AACA,EAAMC,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,CAAjB,CAA1B,CAAA;;AACA,EAAI,IAAA,CAACM,OAAD,CAAyBoE,GAAAA,IAAAA,WAAW,CAACD,KAAD,CAAA,GAAA,EAAcD,IAAd,CAAxC,EAA6D;AAC5DC,IAAAA,KAAK,CAAL,EAAA,GAAeF,QAAf,CAAA;AACAE,IAAAA,KAAK,CAAClD,YAAN,GAAqBiD,IAArB,CAAA;;AAEAvE,IAAAA,gBAAgB,CAAA,GAAhB,CAAyC6B,GAAAA,CAAAA,IAAzC,CAA8C2C,KAA9C,CAAA,CAAA;AACA,GAAA;AACD,CAAA;AAED;AACA;AACA;AACA;AACA;;AACO,SAASE,eAAT,CAAyBJ,QAAzB,EAAmCC,IAAnC,EAAyC;AAC/C;AACA,EAAMC,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,CAAjB,CAA1B,CAAA;;AACA,EAAI,IAAA,CAACM,OAAD,CAAyBoE,GAAAA,IAAAA,WAAW,CAACD,KAAD,CAAA,GAAA,EAAcD,IAAd,CAAxC,EAA6D;AAC5DC,IAAAA,KAAK,CAAL,EAAA,GAAeF,QAAf,CAAA;AACAE,IAAAA,KAAK,CAAClD,YAAN,GAAqBiD,IAArB,CAAA;;AAEAvE,IAAAA,gBAAgB,CAAA,GAAhB,CAAkC6B,IAAlC,CAAuC2C,KAAvC,CAAA,CAAA;AACA,GAAA;AACD,CAAA;AAED;;AACO,SAASG,MAAT,CAAgBC,YAAhB,EAA8B;AACpC1E,EAAAA,WAAW,GAAG,CAAd,CAAA;AACA,EAAA,OAAO2E,OAAO,CAAC,YAAA;AAAA,IAAO,OAAA;AAAEC,MAAAA,OAAO,EAAEF,YAAAA;AAAX,KAAP,CAAA;AAAA,GAAD,EAAoC,EAApC,CAAd,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;AACA;;AACO,SAASG,mBAAT,CAA6BC,GAA7B,EAAkCC,YAAlC,EAAgDV,IAAhD,EAAsD;AAC5DrE,EAAAA,WAAW,GAAG,CAAd,CAAA;AACAwE,EAAAA,eAAe,CACd,YAAM;AACL,IAAA,IAAI,OAAOM,GAAP,IAAc,UAAlB,EAA8B;AAC7BA,MAAAA,GAAG,CAACC,YAAY,EAAb,CAAH,CAAA;AACA,MAAO,OAAA,YAAA;AAAA,QAAMD,OAAAA,GAAG,CAAC,IAAD,CAAT,CAAA;AAAA,OAAP,CAAA;AACA,KAHD,MAGO,IAAIA,GAAJ,EAAS;AACfA,MAAAA,GAAG,CAACF,OAAJ,GAAcG,YAAY,EAA1B,CAAA;AACA,MAAO,OAAA,YAAA;AAAA,QAAA,OAAOD,GAAG,CAACF,OAAJ,GAAc,IAArB,CAAA;AAAA,OAAP,CAAA;AACA,KAAA;AACD,GATa,EAUdP,IAAI,IAAI,IAAR,GAAeA,IAAf,GAAsBA,IAAI,CAACW,MAAL,CAAYF,GAAZ,CAVR,CAAf,CAAA;AAYA,CAAA;AAED;AACA;AACA;AACA;AACA;AACA;;AACO,SAASH,OAAT,CAAiBM,OAAjB,EAA0BZ,IAA1B,EAAgC;AACtC;AACA,EAAMC,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,CAAjB,CAA1B,CAAA;;AACA,EAAA,IAAI0E,WAAW,CAACD,KAAD,CAAcD,GAAAA,EAAAA,IAAd,CAAf,EAAoC;AACnCC,IAAAA,KAAK,CAAA,GAAL,GAAsBW,OAAO,EAA7B,CAAA;AACAX,IAAAA,KAAK,CAAClD,YAAN,GAAqBiD,IAArB,CAAA;AACAC,IAAAA,KAAK,CAAL,GAAA,GAAiBW,OAAjB,CAAA;AACA,IAAA,OAAOX,KAAP,CAAA,GAAA,CAAA;AACA,GAAA;;AAED,EAAA,OAAOA,KAAP,CAAA,EAAA,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;;AACO,SAASY,WAAT,CAAqBd,QAArB,EAA+BC,IAA/B,EAAqC;AAC3CrE,EAAAA,WAAW,GAAG,CAAd,CAAA;AACA,EAAA,OAAO2E,OAAO,CAAC,YAAA;AAAA,IAAA,OAAMP,QAAN,CAAA;AAAA,GAAD,EAAiBC,IAAjB,CAAd,CAAA;AACA,CAAA;AAED;AACA;AACA;;AACO,SAASc,UAAT,CAAoBC,OAApB,EAA6B;AACnC,EAAMC,IAAAA,QAAQ,GAAGvF,gBAAgB,CAACsF,OAAjB,CAAyBA,OAAzB,CAAjB,GAAA,CAAA,CADmC;AAGnC;AACA;;AACA;;AACA,EAAMd,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,CAAjB,CAA1B,CANmC;AAQnC;AACA;;AACAyE,EAAAA,KAAK,CAAL,CAAA,GAAiBc,OAAjB,CAAA;AACA,EAAA,IAAI,CAACC,QAAL,EAAe,OAAOD,OAAP,IAXoB;;AAanC,EAAA,IAAId,KAAK,CAAA,EAAL,IAAgB,IAApB,EAA0B;AACzBA,IAAAA,KAAK,CAAL,EAAA,GAAe,IAAf,CAAA;AACAe,IAAAA,QAAQ,CAACC,GAAT,CAAaxF,gBAAb,CAAA,CAAA;AACA,GAAA;;AACD,EAAA,OAAOuF,QAAQ,CAACvB,KAAT,CAAeyB,KAAtB,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;;AACO,SAASC,aAAT,CAAuBD,KAAvB,EAA8BE,SAA9B,EAAyC;AAC/C,EAAItF,IAAAA,OAAO,CAACqF,aAAZ,EAA2B;AAC1BrF,IAAAA,OAAO,CAACqF,aAAR,CACCC,SAAS,GAAGA,SAAS,CAACF,KAAD,CAAZ,GAAyCA,KADnD,CAAA,CAAA;AAGA,GAAA;AACD,CAAA;AAED;AACA;AACA;AACA;;AACO,SAASG,gBAAT,CAA0B1D,EAA1B,EAA8B;AACpC;AACA,EAAMsC,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,EAAjB,CAA1B,CAAA;AACA,EAAM8F,IAAAA,QAAQ,GAAGpD,QAAQ,EAAzB,CAAA;AACA+B,EAAAA,KAAK,CAAL,EAAA,GAAetC,EAAf,CAAA;;AACA,EAAA,IAAI,CAAClC,gBAAgB,CAAC8F,iBAAtB,EAAyC;AACxC9F,IAAAA,gBAAgB,CAAC8F,iBAAjB,GAAqC,UAACC,GAAD,EAAMC,SAAN,EAAoB;AACxD,MAAA,IAAIxB,KAAJ,CAAkBA,EAAAA,EAAAA,KAAK,GAAL,CAAauB,GAAb,EAAkBC,SAAlB,CAAA,CAAA;AAClBH,MAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYE,GAAZ,CAAA,CAAA;AACA,KAHD,CAAA;AAIA,GAAA;;AACD,EAAA,OAAO,CACNF,QAAQ,CAAC,CAAD,CADF,EAEN,YAAM;AACLA,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYtE,SAAZ,CAAA,CAAA;AACA,GAJK,CAAP,CAAA;AAMA,CAAA;AAED;;AACO,SAAS0E,KAAT,GAAiB;AACvB;AACA,EAAMzB,IAAAA,KAAK,GAAGlC,YAAY,CAACvC,YAAY,EAAb,EAAiB,EAAjB,CAA1B,CAAA;;AACA,EAAI,IAAA,CAACyE,KAAD,CAAA,EAAJ,EAAmB;AAClB;;AACA;AACA,IAAI0B,IAAAA,IAAI,GAAGlG,gBAAH,CAAR,GAAA,CAAA;;AACA,IAAA,OAAOkG,IAAI,KAAK,IAAT,IAAiB,CAACA,IAAD,CAAjB,GAAA,IAAgCA,IAAI,CAAA,EAAJ,KAAiB,IAAxD,EAA8D;AAC7DA,MAAAA,IAAI,GAAGA,IAAH,CAAJ,EAAA,CAAA;AACA,KAAA;;AAED,IAAA,IAAIC,IAAI,GAAGD,IAAI,CAAA,GAAJ,KAAeA,IAAI,CAAJ,GAAA,GAAa,CAAC,CAAD,EAAI,CAAJ,CAA5B,CAAX,CAAA;AACA1B,IAAAA,KAAK,CAAA,EAAL,GAAe,GAAA,GAAM2B,IAAI,CAAC,CAAD,CAAV,GAAgB,GAAhB,GAAsBA,IAAI,CAAC,CAAD,CAAJ,EAArC,CAAA;AACA,GAAA;;AAED,EAAA,OAAO3B,KAAP,CAAA,EAAA,CAAA;AACA,CAAA;AAED;AACA;AACA;;AACA,SAAS4B,sBAAT,GAAkC;AACjC,EAAA,IAAIpE,SAAJ,CAAA;;AACA,EAAA,OAAQA,SAAS,GAAG7B,iBAAiB,CAACkG,KAAlB,EAApB,EAAgD;AAC/C,IAAA,IAAI,CAACrE,SAAD,CAAA,GAAA,IAAyB,CAACA,SAAD,IAA7B,EAAiD,SAAA;;AACjD,IAAI,IAAA;AACHA,MAAAA,SAAS,CAAA,GAAT,CAAkCZ,GAAAA,CAAAA,OAAlC,CAA0CI,aAA1C,CAAA,CAAA;;AACAQ,MAAAA,SAAS,CAAA,GAAT,CAAkCZ,GAAAA,CAAAA,OAAlC,CAA0CK,YAA1C,CAAA,CAAA;;AACAO,MAAAA,SAAS,CAAT,GAAA,CAAA,GAAA,GAAoC,EAApC,CAAA;AACA,KAJD,CAIE,OAAOG,CAAP,EAAU;AACXH,MAAAA,SAAS,CAAT,GAAA,CAAA,GAAA,GAAoC,EAApC,CAAA;;AACA3B,MAAAA,OAAO,CAAA,GAAP,CAAoB8B,CAApB,EAAuBH,SAAvB,CAAA,GAAA,CAAA,CAAA;AACA,KAAA;AACD,GAAA;AACD,CAAA;;AAED,IAAIsE,OAAO,GAAG,OAAOC,qBAAP,IAAgC,UAA9C,CAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,cAAT,CAAwBlC,QAAxB,EAAkC;AACjC,EAAA,IAAMmC,IAAI,GAAG,SAAPA,IAAO,GAAM;AAClBC,IAAAA,YAAY,CAACC,OAAD,CAAZ,CAAA;AACA,IAAA,IAAIL,OAAJ,EAAaM,oBAAoB,CAACC,GAAD,CAApB,CAAA;AACbC,IAAAA,UAAU,CAACxC,QAAD,CAAV,CAAA;AACA,GAJD,CAAA;;AAKA,EAAA,IAAMqC,OAAO,GAAGG,UAAU,CAACL,IAAD,EAAO1F,WAAP,CAA1B,CAAA;AAEA,EAAA,IAAI8F,GAAJ,CAAA;;AACA,EAAA,IAAIP,OAAJ,EAAa;AACZO,IAAAA,GAAG,GAAGN,qBAAqB,CAACE,IAAD,CAA3B,CAAA;AACA,GAAA;AACD;AAGD;AACA;;AACA;AACA;AACA;AACA;AACA;;;AACA,SAAS7E,UAAT,CAAoBmF,cAApB,EAAoC;AACnC,EAAIA,IAAAA,cAAc,KAAK,CAAnB,IAAwB/F,OAAO,KAAKX,OAAO,CAACkG,qBAAhD,EAAuE;AACtEvF,IAAAA,OAAO,GAAGX,OAAO,CAACkG,qBAAlB,CAAA;AACA,IAAA,CAACvF,OAAO,IAAIwF,cAAZ,EAA4BJ,sBAA5B,CAAA,CAAA;AACA,GAAA;AACD,CAAA;AAED;AACA;AACA;AACA;;;AACA,SAAS5E,aAAT,CAAuBwF,IAAvB,EAA6B;AAC5B;AACA;AACA,EAAMC,IAAAA,IAAI,GAAGjH,gBAAb,CAAA;AACA,EAAIkH,IAAAA,OAAO,GAAGF,IAAH,CAAX,GAAA,CAAA;;AACA,EAAA,IAAI,OAAOE,OAAP,IAAkB,UAAtB,EAAkC;AACjCF,IAAAA,IAAI,CAAJ,GAAA,GAAgBzF,SAAhB,CAAA;AACA2F,IAAAA,OAAO,EAAA,CAAA;AACP,GAAA;;AAEDlH,EAAAA,gBAAgB,GAAGiH,IAAnB,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASxF,YAAT,CAAsBuF,IAAtB,EAA4B;AAC3B;AACA;AACA,EAAMC,IAAAA,IAAI,GAAGjH,gBAAb,CAAA;AACAgH,EAAAA,IAAI,CAAA,GAAJ,GAAgBA,IAAI,GAAJ,EAAhB,CAAA;AACAhH,EAAAA,gBAAgB,GAAGiH,IAAnB,CAAA;AACA,CAAA;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASxC,WAAT,CAAqB0C,OAArB,EAA8BC,OAA9B,EAAuC;AACtC,EAAA,OACC,CAACD,OAAD,IACAA,OAAO,CAACxF,MAAR,KAAmByF,OAAO,CAACzF,MAD3B,IAEAyF,OAAO,CAACrF,IAAR,CAAa,UAACsF,GAAD,EAAM9E,KAAN,EAAA;AAAA,IAAA,OAAgB8E,GAAG,KAAKF,OAAO,CAAC5E,KAAD,CAA/B,CAAA;AAAA,GAAb,CAHD,CAAA;AAKA,CAAA;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASK,cAAT,CAAwByE,GAAxB,EAA6BC,CAA7B,EAAgC;AAC/B,EAAO,OAAA,OAAOA,CAAP,IAAY,UAAZ,GAAyBA,CAAC,CAACD,GAAD,CAA1B,GAAkCC,CAAzC,CAAA;AACA;;;;"}