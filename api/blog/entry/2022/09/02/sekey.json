{"title":"Managing SSH keys with Sekey and Touch ID","url":"/blog/entry/2022/09/02/sekey","slug":"sekey","author":"vinh","preview":"I have been using Sekey for more than 4 years","created":"2022-09-02T14:22:27.599Z","updated":"2022-09-02T14:22:27.599Z","content":"<p>I have been using <em><strong>Sekey</strong></em> for more than 4 years, I could say the experience\nis better than using SSH private key with passphrase. Sekey will ask for Touch\nID authentication every time I use the private key, it serves great as a second\nfactor when I work with SSH and git. For example: Everytime I push a commit,\nSekey will ask for permission. If I run a script that modify my git repository,\nthe Touch ID popup will pop out, the script could not silently modify git\nrepository without my notice.</p>\n<p>Sekey will generate and store SSH keys in Secure Enclave and will not expose\nprivate key. The public key could be export to transfer to remote host, the\nTouch ID will be used to authenticate SSH connection instead of private key and\npassphrase.</p>\n<p>When I first used Sekey, I was confused because Sekey didn't let me see my\nprivate keys, they were stored in Secure Enclave. But it is a feature, we will\nnot worry of leaking these privated keys.</p>\n<h2>Installation</h2>\n<p><a href=\"https://github.com/sekey/sekey#install\" target=\"_blank\" rel=\"nofollow noreferrer noopener\">https://github.com/sekey/sekey#install</a></p>\n<h2>Authenticating 2 Github accounts</h2>\n<p>The problem with 2 Github accounts is they are using the same username and\nhostname for SSH connection. We need a way to distinguish between accounts.</p>\n<p>We will use <em><strong>git</strong></em> config to make the hostname of those accounts look\ndifferent. Then we will config <em><strong>SSH</strong></em> sending identity to remote host.</p>\n<h3>Export public keys for SSH config</h3>\n<pre><code class=\"language-bash\">sekey --export-key &lt;key-id-1&gt; &gt; ~/.ssh/key_1.pub\nsekey --export-key &lt;key-id-2&gt; &gt; ~/.ssh/key_2.pub\n</code></pre>\n<h3><code>$HOME/.gitconfig</code></h3>\n<pre><code>[url &quot;git@github.com-account-1:account-1/&quot;]\n    insteadOf = git@github.com:account-1/\n\n[url &quot;git@github.com-account-2:account-2/&quot;]\n    insteadOf = git@github.com:account-2/\n</code></pre>\n<h3><code>$HOME/.ssh/config</code></h3>\n<pre><code>Host github.com-account-1\n    HostName github.com\n    IdentityFile ~/.ssh/key_1.pub\n    IdentitiesOnly yes\n\nHost github.com-account-2\n    HostName github.com\n    IdentityFile ~/.ssh/key_2.pub\n    IdentitiesOnly yes\n</code></pre>\n<h2>Too many failed attempts</h2>\n<p>When I was using Macbook Pro 2017, the Touch ID was not so accurate, I got many\nfailed scans because my fingers was getting wet. In such case, the Touch ID may\nlocked. I need to lock the computer and use password or Touch ID to unlock, the\nTouch ID will happily work again with Sekey.</p>\n","tags":["git","github","macos","sekey","ssh"]}